<!doctype html><html lang=ja-jp><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.58.3"><title>Goで順列（permutation）を実装する - 1mmもわからん</title><meta property=og:title content="Goで順列（permutation）を実装する - 1mmもわからん"><link href=https://raahii.github.io/favicon.ico rel=icon type=image/x-icon><link rel=icon href=https://raahii.github.io/images/favicon.ico type=image/x-icon><link rel=stylesheet href=https://raahii.github.io/css/main.css media=all><link rel=stylesheet href="//fonts.googleapis.com/css?family=Merriweather:400|Lato:400,400italic,700"></head><body><div class=wrapper><header class=header><nav class=nav><a href=https://raahii.github.io/ class=nav-logo><img src=https://raahii.github.io/images/logo.png width=50 height=50 alt=Logo><p class=nav-title>1mmもわからん</p></a><ul class=nav-links><li><a href=/about/>About</a></li><li><a href=https://github.com/raahii target=_blank>GitHub</a></li><li><a href=https://twitter.com/raahiiy target=_blank>Twitter</a></li></ul></nav></header><main class=content role=main><article class=article><h1 class=article-title>Goで順列（permutation）を実装する</h1><span class=article-date>April 7, 2019</span>
<span class=article-duration>1 min read</span><div class=article-content><p>配列の並び替えのパターンの列挙をする関数をgolangで書く．<a href=https://atcoder.jp/contests/abc123>ABC123</a>で必要になったので．</p><h1 id=tl-dr>TL;DR</h1><p>QuickPermを使うと良さそうです．</p><script src=https://gist.github.com/raahii/6dd5f44e469f32200bd805700981a10d.js></script><script src=https://gist.github.com/raahii/e53932d299c38a52ad5f114ca6641e1c.js></script><p>上記はコピペ用でこっからはいくつか方法を試して最後に速度比較します．</p><h1 id=方法1-naive-dfs>方法1: naive dfs</h1><p>素直にdfsをする．前から数字を決めていって，決めたらその数字を選択肢から消して次へ行く．全部使ったら（選択肢が無くなったら）1つのパターンとして採択する．</p><script src=https://gist.github.com/raahii/9115d1bd0592aec243f47987c4c7dc4a.js></script><p>上のコードで使ってるサブ関数たちです．この後の方法でも使ってるのですが面倒なので1度だけ掲載．</p><script src=https://gist.github.com/raahii/f0f3d7e2fd8c4b8f11c7278b45e43858.js></script><h1 id=方法2-heap-algorithm>方法2: Heap Algorithm</h1><p><a href=https://ja.wikipedia.org/wiki/Heap%E3%81%AE%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0>Heapのアルゴリズム</a> を使う．</p><script src=https://gist.github.com/raahii/d0fa00607fda89cb954607d188371e0e.js></script><h1 id=方法3-quickperm>方法3: QuickPerm</h1><p><a href=http://www.quickperm.org/>QuickPerm</a>を使う．</p><script src=https://gist.github.com/raahii/23e962eb81a43275445702cc0101381e.js></script><h1 id=方法4-おまけ-quickperm-channel>方法4（おまけ）: QuickPerm + Channel</h1><p><a href=https://stackoverflow.com/questions/30226438/generate-all-permutations-in-go>Generate all permutations in go</a>とかを見ているとChannelを使った実装をしているので早いのか？と思って試してみた．</p><script src=https://gist.github.com/raahii/2d6128b09895c388e223f55ffacdea7f.js></script><h1 id=速度比較>速度比較</h1><p>go testでベンチマーク取ります．</p><script src=https://gist.github.com/raahii/1186cc916e7c54531e73a82ef42de679.js></script><p>方法3のQuickPermが一番早そうです．方法4は非同期でやっても単に結果くるまでブロッキングしてるので，goroutineやchannelの生成の分で普通に遅そうですね．まだgoroutineを書くの慣れてないのでコードが怪しいかもしれません．</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4>goos: darwin
goarch: amd64
pkg: github.com/raahii/go-sandbox/permutations
BenchmarkPermute1-4  2    684403978 ns/op   637542560 B/op   9895161 allocs/op
BenchmarkPermute2-4  5    285790686 ns/op   377401424 B/op   3628802 allocs/op
BenchmarkPermute3-4  5    216943042 ns/op   377401440 B/op   3628802 allocs/op
BenchmarkPermute4-4  1   1215330546 ns/op   290305888 B/op   3628817 allocs/op
PASS
ok      github.com/raahii/go-sandbox/permutations       7.580s</pre></div></div></article><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"raahii"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></main><footer class=footer><ul class=footer-links><li><a href=https://gohugo.io/ class=footer-links-kudos>Made with <img src=https://raahii.github.io/images/hugo-logo.png width=22 height=22></a></li></ul></footer></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-86522604-4','auto');ga('send','pageview');}</script></body></html>